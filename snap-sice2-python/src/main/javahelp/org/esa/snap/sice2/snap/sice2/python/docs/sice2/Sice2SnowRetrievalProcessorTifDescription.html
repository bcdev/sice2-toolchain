<!--
  ~ Copyright (C) 2010 Brockmann Consult GmbH (info@brockmann-consult.de)
  ~
  ~ This program is free software; you can redistribute it and/or modify it
  ~ under the terms of the GNU General Public License as published by the Free
  ~ Software Foundation; either version 3 of the License, or (at your option)
  ~ any later version.
  ~ This program is distributed in the hope that it will be useful, but WITHOUT
  ~ ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  ~ FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
  ~ more details.
  ~
  ~ You should have received a copy of the GNU General Public License along
  ~ with this program; if not, see http://www.gnu.org/licenses/
  -->

<html>
<head>
    <title>SNAP Data Processors - SICE2 Snow Retrieval Processors Description</title>
    <link rel="stylesheet" href="../style.css">
</head>

<body>

<table class="header">
    <tr class="header">
        <td class="header">&nbsp;
            SNAP Data Processors - SICE2 Snow Retrieval Processors Description
        </td>
        <td class="header" align="right"><a
                href="nbdocs://org.esa.snap.snap.help/org/esa/snap/snap/help/docs/general/overview/SnapOverview.html"><img
                src="../images/snap_header.jpg"
                border=0></a>
        </td>
    </tr>
</table>

<h2>Processor Description</h2>

<h3>I/O Parameters Tab</h3>

<img src="../images/sice2_v21_tifs_io.png">

<h4>Source Product Group</h4>

<p class="i1">
    <b>Name: </b>
    The processor does not expect a dedicated source product. The sources are expected as single tif files
    in a specified directory (see processing parameters below).
</p>

<h4>Target Product Group</h4>

<p class="i1">
    <b>Name:</b>
    Used to specify the name of the target product.
</p>

<p class="i1">
    <b>Save to:</b>
    Used to specify whether the target product should be saved to the file system. The
    combo box presents a list of file formats.
</p>

<p class="i1">
    <b>Open in SNAP:</b>
    Used to specify whether the target product should be opened in the Sentinel Toolbox.
    When the target product is not saved, it is opened in the Sentinel Toolbox automatically.
</p>

<br>

<h3>Processing Parameters Tab</h3>

<img src="../images/sice2_v21_tifs_params.png">

<h4>Parameters</h4>

<p class="i1">
    <b>Input tif file directory: </b><br><br>

    The directoty containing the GeoTIFF input files.
    The following inputs are <b>mandatory</b> for the snow retrieval:<br><br>

    <b>r_TOA_01.tif, r_TOA_04.tif, r_TOA_17.tif, r_TOA_21.tif,
        SZA.tif, SAA.tif, OZA.tif, OAA.tif,
        O3.tif, height.tif</b>
</p>

<br>

<h3>The Processing Result</h3>
The retrieved snow properties written as bands to the target product are
basically the same as in snow retrieval standard processing mode and listed in the table below:

<br><br>
<table>
    <tr>
        <th>Band name</th>
        <th>Meaning</th>
        <th>Unit</th>
    </tr>

    <tr>
        <td>grain_diameter</td>
        <td>Snow grain diameter</td>
        <td>mm</td>
    </tr>
    <tr>
        <td>snow_specific_area</td>
        <td>Snow-specific surface area</td>
        <td>m^{2}kg^{-1}</td>
    </tr>
    <tr>
        <td>al</td>
        <td>effective absorption length</td>
        <td>mm</td>
    </tr>
    <tr>
        <td>r0</td>
        <td>reflectance of a semi-infinite non-absorbing snow layer</td>
        <td></td>
    </tr>
    <tr>
        <td>isnow</td>
        <td>Snow flag (see table below)</td>
        <td></td>
    </tr>
    <tr>
        <td>pol_type</td>
        <td>type of pollutant: 1(soot), 2( dust), 3 and 4 (other or mixture)</td>
        <td>Vegetation</td>
    </tr>
    <tr>
        <td>albedo_bb_planar_sw</td>
        <td>shortwave broadband planar albedo</td>
        <td>300-2400 nm</td>
    </tr>
    <tr>
        <td>albedo_bb_spherical_sw</td>
        <td>shortwave broadband spherical albedo</td>
        <td>300-2400 nm</td>
    </tr>
    <tr>
        <td>factor</td>
        <td>Snow covered fraction within mixed pixels</td>
        <td></td>
    </tr>
    <tr>
        <td>O3_SICE</td>
        <td>total ozone (OLCI) corrected for ozone scattering</td>
        <td>kgm^{-2}</td>
    </tr>
    <tr>
        <td>cv1</td>
        <td>quality check 1 (see ATBD)</td>
        <td></td>
    </tr>
    <tr>
        <td>cv2</td>
        <td>quality check 2 (see ATBD)</td>
        <td></td>
    </tr>
    <tr>
        <td>impurity_load</td>
        <td>pollutant load</td>
        <td>ppm_weight</td>
    </tr>
    <tr>
        <td>albedo_spectral_spherical_nn (nn=01,..,11,16,..,21), optional</td>
        <td>spectral spherical albedo (OLCI bands 1 to 11 and 16 to 21)</td>
        <td></td>
    </tr>
    <tr>
        <td>albedo_spectral_planar_nn (nn=01,..,11,16,..,21), optional</td>
        <td>spectral planar albedo (OLCI bands 1 to 11 and 16 to 21)</td>
        <td></td>
    </tr>
    <tr>
        <td>rBRR_nn (nn=01,..,21), optional</td>
        <td>bottom of the atmosphere surface reflectance (OLCI bands 1 through 21)</td>
        <td></td>
    </tr>
</table>


<br><br>
Compared to the snow retrieval standard processing mode,
the 'isnow' flag is not written as SNAP flag band, but keeps the original SICE2 toolchain values (see also <b>[5]</b>):

<br><br>
<table>
    <tr>
        <th>isnow value</th>
        <th>Description</th>
    </tr>

    <tr>
        <td>1</td>
        <td>Clean snow</td>
    </tr>
    <tr>
        <td>2</td>
        <td>Polluted snow</td>
    </tr>
    <tr>
        <td>3</td>
        <td>Partly snow covered pixel</td>
    </tr>
    <tr>
        <td>100</td>
        <td>SZA out of range (< 75 deg), no retrival</td>
    </tr>
    <tr>
        <td>102</td>
        <td>TOA reflectance at band 1 < 0.1, no retrieval</td>
    </tr>
    <tr>
        <td>104</td>
        <td>TOA reflectance at band 21 < 0.2, no retrieval</td>
    </tr>
    <tr>
        <td>104</td>
        <td>grain_diameter < 0.1, no retrieval (potential cloud flag)</td>
    </tr>
    <tr>
        <td>105</td>
        <td>Retrieved spherical albedo negative in band 1, 2 or 3</td>
    </tr>
    <tr>
        <td>-n</td>
        <td>Impossible to solve snow spherical albedo equation at band n</td>
    </tr>
</table>


<br><br>
Note that the snow properties are written into a single target product (as in the snow retrieval standard
processing mode), which differs from the original SICE2 toolchain which generates single GeoTIFF files
for each snow property. To exactly map this functionality, an additional band subsetting needs to be applied to
the target product. For detailed information see the corresponding help documentation for the 'Product Subset Dialog'.

<br><br>

<hr>
</body>
</html>